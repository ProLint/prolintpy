# Reading and Visualizing ProLint data files

This section outlines how to use `prolintpy` to load, read and visualize data files
that can be downloaded from the ProLint webserver. The same set of visualization apps are used, we only
have to specify our intentions using the provided when calling the visualization functions.

When you download data from ProLint, they will be compressed into a zip file. Extract its contents.
For this section, we will assume that the data are in a directory called: `Protein`.

### Point and Radar Apps

These apps really only require a pandas DataFrame, which you can specify as a dataframe object or as a
string pointing to the location of the `csv` file. To read the dataframe that is output from ProLint:

```python
# points app
pl.show_points(filename='Protein/3b534e31-03d1-44ee-9355-fb43200d9ac0.csv')

# radar app
pl.show_radar(filename='Protein/3b534e31-03d1-44ee-9355-fb43200d9ac0.csv')
```

### Distance App

The output of the `contacts.compute_lipid_distances()` call is stored as a pickle file. Currently it is called:
`contacts_.pkl` but we may change that in the future.

To read the data and visualize the results simply type:

```python
# read distances:
with open('Protein/contacts_.pkl', 'rb') as fp:
    dist = pickle.load(fp)

# visualize
pl.show_metric_distances(dist)
```

This will embed the distance app inside your JupyterLab environment.

### Network App

The `pl.show_network()` function that displays the network app only requires the location of a network.json file containing the
required nodes and edges. So, there is not much difference between how you would normaly call it.

```python
# We load one of the network.json files downloaded from ProLint
pl.show_network('Protein/Protein__Occupancy__0.5__network.json')
```

### Heatmap & Density Viewer

The `pl.show_contact_projection()` function is meant to be as simple to use as possible. You specify the protein object and a list
of values that you want to map as a color heatmap onto the surface of the protein. The `data.json` file that ProLint provides
contains information on all metrics, so we need to specify which one we want.

```python
# load the data.json file and the pdb file
T = md.load('Protein/girk_BB.pdb')
with open('Protein/data.json') as fh:
    js = json.load(fh)

# Get the metrics contained in the json file
metrics = list(js.keys())

# visualize the first metric
pl.show_contact_projection(T, bf=js[metrics[0]], cmap="Spectral_r")
```

### Density Distribution

ProLint provides a list of `*.npy` files for each lipid in the system. You can use the `pl.show_density()` function to visualize these files
by telling it to ignore the default arguments and provide a list of files:

```python
#  Get the files ending with npy
import os
npy_files = []
for f in os.listdir('GIRK'):
    if f.endswith('npy'):
        npy_files.append(f)

# visualize results
pl.show_density(None, None, None, filenames=npy_files)
```

### Thickness & Curvature

Implementation of the Thickness & Curvature app is still in development and will be made available soon. As such, currently `prolintpy` does
not support this app. Please note, however, that the output files generated by ProLint are standard `.ply` files which can be visualized with
any 3D viewer (e.g. Blender) and you can manipulate them similar to how you would do with any other 3D object.
